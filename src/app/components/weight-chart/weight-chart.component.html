<div class="weight-chart-container">
  <div class="chart-header">
    <h3>CDC Weight Chart - {{ babyGender === 'male' ? 'Boys' : 'Girls' }}</h3>
    <div class="chart-controls">
      <ion-chip [color]="percentileInterpretation.color === '#10b981' ? 'success' : percentileInterpretation.color === '#ef4444' ? 'danger' : 'warning'" size="small">
        {{ currentPercentile }}th percentile
      </ion-chip>
    </div>
  </div>

  <!-- Loading State -->
  <div class="chart-loading" *ngIf="isLoading">
    <ion-spinner name="crescent"></ion-spinner>
    <p>Loading chart...</p>
  </div>

  <!-- Chart Container -->
  <div #chartContainer class="chart-content" *ngIf="!isLoading && weightRecords.length > 0"></div>

  <!-- Empty State -->
  <div class="chart-empty" *ngIf="!isLoading && weightRecords.length === 0">
    <ion-icon name="analytics-outline"></ion-icon>
    <h4>No Weight Data</h4>
    <p>Add weight records to see your baby's growth chart with CDC percentiles</p>
  </div>

  <!-- Chart Info -->
  <div class="chart-info" *ngIf="!isLoading && weightRecords.length > 0">
    <div class="info-grid">
      <div class="info-item">
        <div class="info-label">Current Status</div>
        <div class="info-value" [style.color]="percentileInterpretation.color">
          {{ percentileInterpretation.status }}
        </div>
      </div>
      
      <div class="info-item">
        <div class="info-label">Growth Trend</div>
        <div class="info-value">{{ getGrowthTrend() }}</div>
      </div>
      
      <div class="info-item">
        <div class="info-label">Weight Gain</div>
        <div class="info-value">{{ getWeightGain() }}</div>
      </div>
    </div>

    <div class="interpretation-card" [style.border-left-color]="percentileInterpretation.color">
      <div class="interpretation-header">
        <ion-icon [name]="percentileInterpretation.color === '#10b981' ? 'checkmark-circle' : percentileInterpretation.color === '#ef4444' ? 'warning' : 'information-circle'"></ion-icon>
        <h4>{{ percentileInterpretation.status }}</h4>
      </div>
      <p>{{ percentileInterpretation.message }}</p>
    </div>

    <!-- Percentile Legend -->
    <div class="percentile-legend">
      <h5>Understanding Percentiles</h5>
      <div class="legend-grid">
        <div class="legend-item">
          <div class="legend-color" style="background: #ef4444;"></div>
          <span>3rd-10th: Monitor closely</span>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #10b981;"></div>
          <span>10th-90th: Normal range</span>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background: #f59e0b;"></div>
          <span>90th-97th: Above average</span>
        </div>
      </div>
      <p class="legend-note">
        Percentiles show how your baby compares to other babies of the same age and gender. 
        The 50th percentile is the average.
      </p>
    </div>
  </div>
</div>