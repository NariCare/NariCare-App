<ion-header>
  <ion-toolbar>
    <ion-title>Consultation Report</ion-title>
    <ion-buttons slot="end">
      <ion-button (click)="dismiss()">
        <ion-icon name="close"></ion-icon>
      </ion-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content class="consultation-report-content">
  <div class="report-container">
    
    <!-- Report Header -->
    <div class="report-header">
      <div class="clinic-info">
        <h1>NariCare</h1>
        <p class="clinic-subtitle">Lactation Consultation Services</p>
      </div>
      <div class="report-type">
        <h2>CONSULTATION REPORT</h2>
      </div>
    </div>

    <!-- Patient & Consultation Info -->
    <div class="info-section">
      <div class="info-row">
        <div class="info-item">
          <label>Report Date:</label>
          <span>{{ formatDate(consultation.actual_end_time || consultation.updated_at) }}</span>
        </div>
        <div class="info-item">
          <label>Consultation ID:</label>
          <span>{{ consultation.id.substring(0, 8).toUpperCase() }}</span>
        </div>
      </div>
      
      <div class="info-row">
        <div class="info-item">
          <label>Consultation Date:</label>
          <span>{{ formatDate(consultation.scheduledAt || consultation.scheduled_at) }}</span>
        </div>
        <div class="info-item">
          <label>Time:</label>
          <span>{{ formatTime(consultation.scheduledAt || consultation.scheduled_at) }}</span>
        </div>
      </div>
      
      <div class="info-row">
        <div class="info-item">
          <label>Consultation Type:</label>
          <span>{{ formatTopic(consultation.topic) }}</span>
        </div>
        <div class="info-item">
          <label>Duration:</label>
          <span>30 minutes</span>
        </div>
      </div>
      
      <div class="info-row">
        <div class="info-item">
          <label>Lactation Consultant:</label>
          <span>{{ expertName }}</span>
        </div>
        <div class="info-item">
          <label>Follow-up Required:</label>
          <span class="follow-up-badge" [class.required]="consultation.follow_up_required">
            {{ consultation.follow_up_required ? 'Yes' : 'No' }}
          </span>
        </div>
      </div>
    </div>

    <!-- Assessment Section -->
    <div class="assessment-section">
      <h3>
        <ion-icon name="document-text"></ion-icon>
        Expert Assessment & Recommendations
      </h3>
      <div class="assessment-content" [innerHTML]="getFormattedNotes()"></div>
    </div>

    <!-- Footer -->
    <div class="report-footer">
      <div class="signature-section">
        <div class="signature-line">
          <p class="signature-name">{{ expertName }}</p>
          <p class="signature-title">International Board Certified Lactation Consultant (IBCLC)</p>
          <p class="signature-credentials">Registered Nurse, MSN</p>
        </div>
      </div>
      
      <div class="disclaimer">
        <p><strong>Important:</strong> This report contains recommendations based on our consultation. 
        Please consult with your pediatrician for any medical concerns. For urgent issues, contact your healthcare provider immediately.</p>
      </div>
    </div>

  </div>
</ion-content>

<ion-footer>
  <ion-toolbar>
    <div class="footer-actions">
      <ion-button fill="clear" (click)="dismiss()">
        <ion-icon name="close" slot="start"></ion-icon>
        Close
      </ion-button>
      <ion-button fill="solid" color="primary" (click)="dismiss()">
        <ion-icon name="checkmark" slot="start"></ion-icon>
        Done
      </ion-button>
    </div>
  </ion-toolbar>
</ion-footer>