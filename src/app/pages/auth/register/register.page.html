<ion-content class="register-content">
  <div class="register-container">
    <!-- Top Section with Logo (Gray Background) -->
    <!-- <div class="top-section">
      <div class="logo-container">
        <img src="assets/NariCare logo.svg" alt="NariCare Logo" class="logo-image">
      </div>
    </div> -->

    <!-- Bottom Section with Form (White Background) -->
    <div class="bottom-section">
      <div class="welcome-section">
        <h2 class="signup-title">sign up</h2>
        <p class="signup-subtitle">Create an account to get started</p>
      </div>

      <!-- Registration Form -->
      <form [formGroup]="registerForm" (ngSubmit)="onSubmit()" class="register-form">
        <!-- First Name Field -->
        <div class="input-container">
          <ion-input
            formControlName="firstName"
            placeholder="First Name"
            class="custom-input"
            fill="outline"
            [class.error]="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched">
          </ion-input>
          <div class="error-message" *ngIf="registerForm.get('firstName')?.invalid && registerForm.get('firstName')?.touched">
            {{ getErrorMessage('firstName') }}
          </div>
        </div>

        <!-- Last Name Field -->
        <div class="input-container">
          <ion-input
            formControlName="lastName"
            placeholder="Last Name"
            class="custom-input"
            fill="outline"
            [class.error]="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched">
          </ion-input>
          <div class="error-message" *ngIf="registerForm.get('lastName')?.invalid && registerForm.get('lastName')?.touched">
            {{ getErrorMessage('lastName') }}
          </div>
        </div>

        <!-- Email Address Field -->
        <div class="input-container">
          <ion-input
            formControlName="email"
            type="email"
            placeholder="Email Address"
            class="custom-input"
            fill="outline"
            [class.error]="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
          </ion-input>
          <div class="error-message" *ngIf="registerForm.get('email')?.invalid && registerForm.get('email')?.touched">
            {{ getErrorMessage('email') }}
          </div>
        </div>

        <!-- Phone Number Field -->
        <div class="input-container">
          <ion-input
            formControlName="phoneNumber"
            type="tel"
            placeholder="Phone Number"
            class="custom-input"
            fill="outline"
            (ionInput)="formatPhoneNumber($event, 'phoneNumber')"
            [class.error]="registerForm.get('phoneNumber')?.invalid && registerForm.get('phoneNumber')?.touched">
          </ion-input>
          <div class="error-message" *ngIf="registerForm.get('phoneNumber')?.invalid && registerForm.get('phoneNumber')?.touched">
            {{ getErrorMessage('phoneNumber') }}
          </div>
        </div>

        <!-- WhatsApp Same as Phone Checkbox -->
        <div class="checkbox-container">
          <ion-checkbox formControlName="whatsappSameAsPhone"></ion-checkbox>
          <label class="checkbox-text">WhatsApp number same as phone number</label>
        </div>

        <!-- WhatsApp Number Field - Only show if checkbox is unchecked -->
        <div class="input-container" *ngIf="!registerForm.get('whatsappSameAsPhone')?.value">
          <div class="whatsapp-input-wrapper">
            <ion-icon name="logo-whatsapp" class="whatsapp-icon"></ion-icon>
            <ion-input
              formControlName="whatsappNumber"
              type="tel"
              placeholder="WhatsApp Phone Number"
              class="custom-input whatsapp-input"
              fill="outline"
              (ionInput)="formatPhoneNumber($event, 'whatsappNumber')"
              [class.error]="registerForm.get('whatsappNumber')?.invalid && registerForm.get('whatsappNumber')?.touched">
            </ion-input>
          </div>
          <div class="error-message" *ngIf="registerForm.get('whatsappNumber')?.invalid && registerForm.get('whatsappNumber')?.touched">
            {{ getErrorMessage('whatsappNumber') }}
          </div>
        </div>

        <!-- Password Field -->
        <div class="input-container">
          <ion-input
            formControlName="password"
            [type]="showPassword ? 'text' : 'password'"
            placeholder="Create a password"
            class="custom-input password-input"
            fill="outline"
            [class.error]="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
            <ion-button 
              fill="clear" 
              slot="end" 
              (click)="togglePasswordVisibility('password')"
              class="password-toggle">
              <ion-icon [name]="showPassword ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
            </ion-button>
          </ion-input>
          <div class="error-message" *ngIf="registerForm.get('password')?.invalid && registerForm.get('password')?.touched">
            {{ getErrorMessage('password') }}
          </div>
        </div>

        <!-- Confirm Password Field -->
        <div class="input-container">
          <ion-input
            formControlName="confirmPassword"
            [type]="showConfirmPassword ? 'text' : 'password'"
            placeholder="Confirm password"
            class="custom-input password-input"
            fill="outline"
            [class.error]="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
            <ion-button 
              fill="clear" 
              slot="end" 
              (click)="togglePasswordVisibility('confirmPassword')"
              class="password-toggle">
              <ion-icon [name]="showConfirmPassword ? 'eye-off-outline' : 'eye-outline'"></ion-icon>
            </ion-button>
          </ion-input>
          <div class="error-message" *ngIf="registerForm.get('confirmPassword')?.invalid && registerForm.get('confirmPassword')?.touched">
            {{ getErrorMessage('confirmPassword') }}
          </div>
        </div>

        <!-- Mother Type Selection -->
        <div class="input-container">
          <ion-select 
            formControlName="motherType" 
            placeholder="I am a... (optional)"
            class="custom-select"
            fill="outline"
            interface="popover">
            <ion-select-option value="pregnant">Expecting Mother</ion-select-option>
            <ion-select-option value="new_mom">New Mother</ion-select-option>
          </ion-select>
        </div>

        <!-- Due Date for Pregnant Mothers -->
        <div class="input-container" *ngIf="registerForm.get('motherType')?.value === 'pregnant'">
          <ion-input
            formControlName="dueDate"
            type="date"
            placeholder="Select your due date"
            class="custom-input"
            fill="outline"
            [min]="getTodayDate()"
            [class.error]="registerForm.get('dueDate')?.invalid && registerForm.get('dueDate')?.touched">
          </ion-input>
          <div class="error-message" *ngIf="registerForm.get('dueDate')?.invalid && registerForm.get('dueDate')?.touched">
            {{ getErrorMessage('dueDate') }}
          </div>
        </div>

        <!-- Terms and Conditions Checkbox -->
        <div class="terms-container">
          <div class="checkbox-wrapper">
            <ion-checkbox formControlName="agreeToTerms"></ion-checkbox>
            <label class="terms-text">
              I've read and agree with the <span class="terms-link">Terms and Conditions</span> and the <span class="terms-link">Privacy Policy</span>.
            </label>
          </div>
          <div class="error-message" *ngIf="registerForm.get('agreeToTerms')?.invalid && registerForm.get('agreeToTerms')?.touched">
            You must agree to the terms and conditions
          </div>
        </div>



        <!-- Submit Button -->
        <ion-button 
          expand="block"
          type="submit" 
          [disabled]="!registerForm.valid"
          class="signup-button">
          Create Account
        </ion-button>
      </form>

      <!-- Login Link -->
      <div class="login-section">
        <p class="login-prompt" (click)="navigateToLogin()">
          Already have an account? <label class="login-link">Sign in here</label>
        </p>
      </div>

      <!-- Social Sign-in Section -->
      <div class="social-signin-section">
        <div class="divider-line"></div>
        <p class="social-divider">Or continue with</p>
        
        <div class="social-buttons">
          <ion-button
            (click)="signInWithGoogle()"
            class="social-button google-button"
            fill="clear">
            <ion-icon name="logo-google"></ion-icon>
          </ion-button>
          
          <ion-button
            (click)="signInWithFacebook()"
            class="social-button facebook-button"
            fill="clear">
            <ion-icon name="logo-facebook"></ion-icon>
          </ion-button>
        </div>
      </div>
    </div>
  </div>
</ion-content>